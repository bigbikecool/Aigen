<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå | ‡∏Ñ‡∏ì‡∏¥‡∏ï ‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå ‡πÄ‡∏Ñ‡∏°‡∏µ</title>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Sarabun', sans-serif;
      background: #f0f4f8;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 700px;
      margin: 30px auto;
      background: #fff;
      padding: 25px 30px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    header.header-small {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 25px;
    }
    header.header-small .back-btn {
      text-decoration: none;
      font-size: 1.6em;
      color: #444;
      font-weight: bold;
      transition: color 0.3s ease;
    }
    header.header-small .back-btn:hover {
      color: #0077ff;
    }
    header.header-small h2 {
      margin: 0;
      font-weight: 700;
      color: #222;
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: 600;
      color: #333;
    }
    select, input[type="text"] {
      width: 100%;
      padding: 10px 12px;
      font-size: 1em;
      border: 2px solid #ddd;
      border-radius: 6px;
      margin-top: 5px;
      transition: border-color 0.3s ease;
    }
    select:focus, input[type="text"]:focus {
      border-color: #0077ff;
      outline: none;
    }
    button.btn {
      margin-top: 25px;
      padding: 12px 18px;
      font-size: 1.1em;
      font-weight: 700;
      color: #fff;
      background-color: #0077ff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    button.btn:hover {
      background-color: #005fcc;
    }
    #quiz-output {
      margin-top: 30px;
    }
    .question-box {
      background: #e8f0fe;
      border-radius: 10px;
      padding: 15px 20px;
      margin-bottom: 20px;
    }
    .question-box p {
      font-weight: 600;
      color: #222;
      margin: 0 0 10px 0;
    }
    .question-box ul {
      list-style: none;
      padding-left: 0;
      margin: 0;
    }
    .question-box li {
      margin-bottom: 8px;
    }
    .explanation {
      margin-top: 8px;
      font-size: 0.9em;
      color: #444;
    }
    .correct {
      color: green;
      font-weight: bold;
    }
    .wrong {
      color: red;
      font-weight: bold;
    }
    #score {
      margin-top: 20px;
      font-size: 1.2em;
      font-weight: 700;
      color: #222;
    }
    #checkBtn, #historyBtn {
      display: inline-block;
      margin-top: 15px;
      margin-right: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="header-small">
      <a href="index.html" class="back-btn" title="‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å">‚Üê</a>
      <h2>‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏à‡∏≤‡∏Å AI</h2>
    </header>

    <div class="form-section">
      <label for="subject">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤:</label>
      <select id="subject" onchange="updateTopicOptions()">
        <option value="math">‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</option>
        <option value="physics">‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå</option>
        <option value="chemistry">‡πÄ‡∏Ñ‡∏°‡∏µ</option>
      </select>

      <label for="topic">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠:</label>
      <select id="topic">
        <!-- ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏î‡∏¢ JS -->
      </select>

      <label for="amount">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠:</label>
      <select id="amount">
        <option value="5">5 ‡∏Ç‡πâ‡∏≠</option>
        <option value="10" selected>10 ‡∏Ç‡πâ‡∏≠</option>
        <option value="15">15 ‡∏Ç‡πâ‡∏≠</option>
      </select>

      <label for="difficulty">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å:</label>
      <select id="difficulty">
        <option value="easy">‡∏á‡πà‡∏≤‡∏¢</option>
        <option value="medium" selected>‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
        <option value="hard">‡∏¢‡∏≤‡∏Å</option>
      </select>

      <button class="btn" onclick="handleGenerate()">‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå</button>
    </div>

    <div id="quiz-output"></div>

    <button class="btn" id="checkBtn" onclick="checkAnswers()" style="display:none;">‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button>
    <button class="btn" id="historyBtn" onclick="goHistory()" style="display:none; background-color:#777;">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÇ‡∏à‡∏ó‡∏¢‡πå</button>
    <div id="score"></div>
  </div>

  <script>
    const topicsBySubject = {
      math: [{ value: "‡∏™‡∏°‡∏Å‡∏≤‡∏£", text: "‡∏™‡∏°‡∏Å‡∏≤‡∏£" }],
      physics: [{ value: "‡∏Ñ‡∏•‡∏∑‡πà‡∏ô", text: "‡∏Ñ‡∏•‡∏∑‡πà‡∏ô" }],
      chemistry: [{ value: "‡∏™‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏°‡∏µ", text: "‡∏™‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏°‡∏µ" }]
    };

    let quizData = [];

    function updateTopicOptions() {
      const subject = document.getElementById("subject").value;
      const topicSelect = document.getElementById("topic");
      topicSelect.innerHTML = "";

      topicsBySubject[subject].forEach(topic => {
        const option = document.createElement("option");
        option.value = topic.value;
        option.textContent = topic.text;
        topicSelect.appendChild(option);
      });
    }

    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
    updateTopicOptions();

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ì‡∏¥‡∏ï
    function generateEquation() {
      const a = getRandomInt(1, 10);
      const x = getRandomInt(1, 10);
      const b = getRandomInt(0, 10);
      const c = a * x + b;
      const question = `${a}x + ${b} = ${c}`;
      const correctAnswer = x;
      const explanation = `‡πÅ‡∏Å‡πâ‡∏™‡∏°‡∏Å‡∏≤‡∏£: ${a}x + ${b} = ${c} ‚Üí ${a}x = ${c - b} ‚Üí x = ${(c - b) / a}`;

      let choices = [correctAnswer];
      while (choices.length < 4) {
        const fake = getRandomInt(correctAnswer - 5, correctAnswer + 5);
        if (!choices.includes(fake)) choices.push(fake);
      }

      choices = choices.sort(() => Math.random() - 0.5);

      return { question, choices, answer: correctAnswer, explanation };
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏™‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏°‡∏µ (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏á‡πà‡∏≤‡∏¢)
    function generateChemicalEquation() {
      // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏°‡∏µ‡∏á‡πà‡∏≤‡∏¢ ‡πÜ (‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á)
      const reactions = [
        {
          question: "H‚ÇÇ + O‚ÇÇ ‚Üí ?",
          correctAnswer: "H‚ÇÇO",
          choices: ["H‚ÇÇO‚ÇÇ", "H‚ÇÇO", "O‚ÇÇH", "OH‚ÇÇ"],
          explanation: "‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ô‡πâ‡∏≥: 2H‚ÇÇ + O‚ÇÇ ‚Üí 2H‚ÇÇO"
        },
        {
          question: "Na + Cl‚ÇÇ ‚Üí ?",
          correctAnswer: "NaCl",
          choices: ["NaCl‚ÇÇ", "NaCl", "Na‚ÇÇCl", "Na‚ÇÇCl‚ÇÇ"],
          explanation: "‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ã‡πÄ‡∏î‡∏µ‡∏¢‡∏°‡∏Ñ‡∏•‡∏≠‡πÑ‡∏£‡∏î‡πå: 2Na + Cl‚ÇÇ ‚Üí 2NaCl"
        },
        {
          question: "C + O‚ÇÇ ‚Üí ?",
          correctAnswer: "CO‚ÇÇ",
          choices: ["CO", "CO‚ÇÇ", "C‚ÇÇO", "O‚ÇÇC"],
          explanation: "‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô‡πÑ‡∏î‡∏≠‡∏≠‡∏Å‡πÑ‡∏ã‡∏î‡πå: C + O‚ÇÇ ‚Üí CO‚ÇÇ"
        },
        {
          question: "Fe + O‚ÇÇ ‚Üí ?",
          correctAnswer: "Fe‚ÇÇO‚ÇÉ",
          choices: ["FeO", "Fe‚ÇÇO‚ÇÉ", "FeO‚ÇÇ", "Fe‚ÇÉO‚ÇÑ"],
          explanation: "‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏ô‡∏¥‡∏°‡πÄ‡∏´‡∏•‡πá‡∏Å: 4Fe + 3O‚ÇÇ ‚Üí 2Fe‚ÇÇO‚ÇÉ"
        }
      ];

      const chosen = reactions[getRandomInt(0, reactions.length - 1)];
      let choices = [...chosen.choices];
      choices = choices.sort(() => Math.random() - 0.5);

      return {
        question: chosen.question,
        choices,
        answer: chosen.correctAnswer,
        explanation: chosen.explanation
      };
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏•‡∏∑‡πà‡∏ô (‡∏á‡πà‡∏≤‡∏¢‡πÜ)
    function generatePhysicsWave() {
      // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏•‡∏∑‡πà‡∏ô (‡∏´‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà f = v / Œª)
      const velocity = getRandomInt(10, 100); // ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏Ñ‡∏•‡∏∑‡πà‡∏ô (m/s)
      const wavelength = getRandomInt(1, 20); // ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ñ‡∏•‡∏∑‡πà‡∏ô (m)
      const frequency = parseFloat((velocity / wavelength).toFixed(2)); // Hz
      const question = `‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß ${velocity} m/s ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ñ‡∏•‡∏∑‡πà‡∏ô ${wavelength} ‡πÄ‡∏°‡∏ï‡∏£ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡πÉ‡∏î (Hz)?`;

      let choices = [frequency];
      while (choices.length < 4) {
        let fakeFreq = parseFloat((frequency + getRandomInt(-5, 5)).toFixed(2));
        if (fakeFreq > 0 && !choices.includes(fakeFreq)) choices.push(fakeFreq);
      }
      choices = choices.sort(() => Math.random() - 0.5);

      const explanation = `‡∏™‡∏π‡∏ï‡∏£: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà f = ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏Ñ‡∏•‡∏∑‡πà‡∏ô (v) / ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ñ‡∏•‡∏∑‡πà‡∏ô (Œª) ‚Üí f = ${velocity} / ${wavelength} = ${frequency} Hz`;

      return { question, choices, answer: frequency, explanation };
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏Ç
    function getRandomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ï‡∏≤‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡πÅ‡∏•‡∏∞‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠
    function handleGenerate() {
      const subject = document.getElementById("subject").value;
      const topic = document.getElementById("topic").value;
      const amount = parseInt(document.getElementById("amount").value);
      const difficulty = document.getElementById("difficulty").value;
      const quizContainer = document.getElementById("quiz-output");
      const scoreDiv = document.getElementById("score");
      scoreDiv.innerHTML = "";
      quizContainer.innerHTML = "";

      quizData = [];

      for (let i = 1; i <= amount; i++) {
        let qObj;
        if (subject === "math" && topic === "‡∏™‡∏°‡∏Å‡∏≤‡∏£") {
          qObj = generateEquation();
        } else if (subject === "chemistry" && topic === "‡∏™‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏°‡∏µ") {
          qObj = generateChemicalEquation();
        } else if (subject === "physics" && topic === "‡∏Ñ‡∏•‡∏∑‡πà‡∏ô") {
          qObj = generatePhysicsWave();
        } else {
          quizContainer.innerHTML = `<p style="color:red;">üîí ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö</p>`;
          document.getElementById("checkBtn").style.display = "none";
          document.getElementById("historyBtn").style.display = "none";
          return;
        }

        quizData.push(qObj);

        const questionHTML = `
          <div class="question-box" id="q${i}">
            <p><strong>‡∏Ç‡πâ‡∏≠ ${i}:</strong> ${qObj.question}</p>
            <ul>
              ${qObj.choices.map(choice => `
                <li>
                  <label>
                    <input type="radio" name="q${i}" value="${choice}">
                    ${choice}
                  </label>
                </li>
              `).join("")}
            </ul>
            <div class="explanation" id="explain${i}" style="display:none;"></div>
          </div>
        `;
        quizContainer.innerHTML += questionHTML;
      }
      document.getElementById("checkBtn").style.display = "inline-block";
      document.getElementById("historyBtn").style.display = "inline-block";
    }

    // ‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
    function checkAnswers() {
      let score = 0;
      quizData.forEach((q, index) => {
        const qNum = index + 1;
        const selected = document.querySelector(`input[name="q${qNum}"]:checked`);
        const explainDiv = document.getElementById(`explain${qNum}`);
        explainDiv.style.display = "block";

        if (selected) {
          if (selected.value == q.answer) {
            explainDiv.innerHTML = `<span class="correct">‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!</span> ${q.explanation}`;
            score++;
          } else {
            explainDiv.innerHTML = `<span class="wrong">‚ùå ‡∏ú‡∏¥‡∏î</span> ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏∑‡∏≠ ${q.answer}. ${q.explanation}`;
          }
        } else {
          explainDiv.innerHTML = `<span class="wrong">‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</span>`;
        }
      });

      document.getElementById("score").innerHTML = `<h3>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°: ${score} / ${quizData.length}</h3>`;

      saveHistory(
        document.getElementById("subject").value,
        document.getElementById("topic").value,
        score,
        quizData.length
      );
    }

    // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏•‡∏á localStorage
    function saveHistory(subject, topic, score, total) {
      const history = JSON.parse(localStorage.getItem("quizHistory") || "[]");
      const now = new Date();
      const entry = {
        subject,
        topic,
        score,
        total,
        date: now.toLocaleString("th-TH", { dateStyle: "short", timeStyle: "short" })
      };
      history.unshift(entry);
      localStorage.setItem("quizHistory", JSON.stringify(history));
    }

    // ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
    function goHistory() {
      window.location.href = "history.html";
    }
  </script>
</body>
</html>
